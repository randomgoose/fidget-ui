<!-- <textarea id="input"></textarea> -->

<script>
  window.onmessage = (msg) => {
    switch (msg.data.pluginMessage.type) {
      case 'COPY':
        copy(msg.data.pluginMessage.payload);
        break;
    }
  };

  function copy(text) {
    const input = 
    document.createElement('textarea');
    document.body.appendChild(input);
    input.value = text;
    input.select();
    input.setSelectionRange(0, 99999);

    document.execCommand('copy');

    // The plugin cannot write content to the clipboard
    // if closed immediately
    setInterval(() => {
      window.parent.postMessage({ pluginMessage: { type: 'CODE_COPIED' } }, '*');
    }, 500);
  }
</script>
